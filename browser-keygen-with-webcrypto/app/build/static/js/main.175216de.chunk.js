(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{32:function(e,t,a){e.exports=a(54)},37:function(e,t,a){},39:function(e,t,a){},54:function(e,t,a){"use strict";a.r(t);var n=a(6),r=a.n(n),s=a(31),i=a.n(s),l=(a(37),a(7)),c=a(9),u=a.n(c),o=a(12),h=a(2),m=a(3),v=a(18),y=a(17),p=(a(39),a(0)),f=a(1),b=a(19),E=function(e){Object(v.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).state={algorithm:"",curve:"",bits:"",usage:["sign","verify"]},n}return Object(m.a)(a,[{key:"setAlgorithm",value:function(e){var t=e.target.value;this.setState((function(e){return Object.assign({},e,{algorithm:t})}))}},{key:"setKeySize",value:function(e){var t=+e.target.value;this.setState((function(e){return Object.assign({},e,{bits:t})}))}},{key:"setCurve",value:function(e){var t=e.target.value;this.setState((function(e){return Object.assign({},e,{curve:t})}))}},{key:"generate",value:function(){var e=Object(o.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},"RSA"===this.state.algorithm?(-1!==this.state.usage.indexOf("sign")||-1!==this.state.usage.indexOf("verify")?t.name="RSA-PSS":t.name="RSA-OAEP",t.modulusLength=+this.state.bits,t.publicExponent=new Uint8Array([1,0,1]),t.hash={name:"SHA-256"}):(t.name="ECDSA",t.namedCurve=this.state.curve),e.next=4,crypto.subtle.generateKey(t,!0,this.state.usage);case 4:a=e.sent,this.props.setKeys(a);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),a}(r.a.Component),d=function(e){Object(v.a)(a,e);var t=Object(y.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"ca-keygen"},r.a.createElement("h3",null,"(DEMO ONLY) Generate CA Keys (DEMO ONLY)"),r.a.createElement("p",null,"This won't be here ordinarily. This just exists to make this demo testable with ",r.a.createElement("a",{href:"https://fortifyapp.com/"},"Fortify"),", without needing a RHCS instance."),r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"ca-keytype"},"CA Key Type"),r.a.createElement("select",{name:"ca-keytype",onChange:function(t){return e.setAlgorithm(t)},value:this.state.algorithm},r.a.createElement("option",{default:!0,disabled:!0,value:""},"---"),r.a.createElement("option",{value:"RSA"},"RSA"),r.a.createElement("option",{value:"ECDSA"},"ECDSA"))),"RSA"===this.state.algorithm?r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"ca-keysize-rsa"},"CA Key Size"),r.a.createElement("select",{name:"ca-keysize-rsa",onChange:function(t){return e.setKeySize(t)},value:""+this.state.bits},r.a.createElement("option",{default:!0,disabled:!0,value:""},"---"),r.a.createElement("option",{value:"2048"},"2048"),r.a.createElement("option",{value:"3072"},"3072"),r.a.createElement("option",{value:"4096"},"4096"))):null,"ECDSA"===this.state.algorithm?r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"ca-keysize-ecdsa"},"CA Key Curve"),r.a.createElement("select",{name:"ca-keysize-ecdsa",onChange:function(t){return e.setCurve(t)},value:""+this.state.curve},r.a.createElement("option",{default:!0,disabled:!0,value:""},"---"),r.a.createElement("option",{value:"P-256"},"P-256"),r.a.createElement("option",{value:"P-384"},"P-384"),r.a.createElement("option",{value:"P-521"},"P-521"))):null,"RSA"===this.state.algorithm&&""!==this.state.bits||"ECDSA"===this.state.algorithm&&""!==this.state.curve?r.a.createElement("button",{onClick:function(){return e.generate()}},"Generate"):null)}}]),a}(E),g=function(e){Object(v.a)(a,e);var t=Object(y.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"cert-keygen"},r.a.createElement("h3",null,"Generate Cert Keys"),r.a.createElement("p",null,"When using fortify, these certificates should be generated onto the card itself."),r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"cert-keytype"},"Cert Key Type"),r.a.createElement("select",{name:"cert-keytype",onChange:function(t){return e.setAlgorithm(t)},value:this.state.algorithm},r.a.createElement("option",{default:!0,disabled:!0,value:""},"---"),r.a.createElement("option",{value:"RSA"},"RSA"),r.a.createElement("option",{value:"ECDSA"},"ECDSA"))),"RSA"===this.state.algorithm?r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"cert-keysize-rsa"},"Cert Key Size"),r.a.createElement("select",{name:"cert-keysize-rsa",onChange:function(t){return e.setKeySize(t)},value:""+this.state.bits},r.a.createElement("option",{default:!0,disabled:!0,value:""},"---"),r.a.createElement("option",{value:"2048"},"2048"),r.a.createElement("option",{value:"3072"},"3072"),r.a.createElement("option",{value:"4096"},"4096"))):null,"ECDSA"===this.state.algorithm?r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"cert-keysize-ecdsa"},"Cert Key Curve"),r.a.createElement("select",{name:"cert-keysize-ecdsa",onChange:function(t){return e.setCurve(t)},value:""+this.state.curve},r.a.createElement("option",{default:!0,disabled:!0,value:""},"---"),r.a.createElement("option",{value:"P-256"},"P-256"),r.a.createElement("option",{value:"P-384"},"P-384"),r.a.createElement("option",{value:"P-521"},"P-521"))):null,"RSA"===this.state.algorithm&&""!==this.state.bits||"ECDSA"===this.state.algorithm&&""!==this.state.curve?r.a.createElement("button",{onClick:function(){return e.generate()}},"Generate"):null)}}]),a}(E),C=function(e){Object(v.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).state={subject:null,city:null,state:null,country:null,orgunit:null,org:null},n}return Object(m.a)(a,[{key:"setFormValue",value:function(e,t){var a={};a[e]=t,this.setState((function(e){return Object.assign({},e,a)}))}},{key:"generate",value:function(){var e=Object(o.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new b.d).version=0,t.subject.typesAndValues.push(new b.b({type:"2.5.4.3",value:new p.PrintableString({value:this.state.subject})})),t.subjectPublicKeyInfo.importKey(this.props.cert_keys.publicKey),t.attributes=[],e.next=7,crypto.subtle.digest({name:"SHA-256"},t.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex);case 7:return a=e.sent,t.attributes.push(new b.a({type:"1.2.840.113549.1.9.14",values:[new b.f({extensions:[new b.e({extnID:"2.5.29.14",critical:!1,extnValue:new p.OctetString({valueHex:a}).toBER(!1)})]}).toSchema()]})),e.next=11,t.sign(this.props.cert_keys.privateKey,"SHA-256");case 11:this.props.setCSR(t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("form",{id:"cert-csr-form",onSubmit:function(t){t.preventDefault(),e.generate()}},r.a.createElement("h3",null,"Generate Certificate Signing Request"),r.a.createElement("p",null,"In the future, this section will include additional fields and allow the user to specify a local CSR to read via a form."),r.a.createElement("div",{className:"input-field"},r.a.createElement("label",{htmlFor:"Subject"},"Subject"),r.a.createElement("input",{name:"Subject",type:"text",value:this.subject,onChange:function(t){return e.setFormValue("subject",t.target.value)}})),r.a.createElement("button",null,"Generate CSR"))}}]),a}(r.a.Component),S=function(e){Object(v.a)(a,e);var t=Object(y.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"generate",value:function(){var e=Object(o.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new b.c,console.log(t,t.toJSON()),t.version=0,t.serialNumber=new p.Integer({value:42}),(a=new Date).setDate(a.getDate()+5),t.notBefore.value=new Date,t.notAfter.value=a,t.issuer.typesAndValues.push(new b.b({type:"2.5.4.3",value:new p.PrintableString({value:"RHCS-DEMO"})})),t.subject=this.props.csr.subject,t.subjectPublicKeyInfo=this.props.csr.subjectPublicKeyInfo,console.log(t,t.toJSON()),console.log(t,Object(f.i)(Object(f.a)(t.encodeTBS().toBER(!1)))),e.next=15,t.sign(this.props.ca_keys.privateKey,"SHA-256");case 15:return console.log(t.toJSON()),e.next=18,t.toSchema().toBER(!1);case 18:n=e.sent,this.props.setCert(n);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"cert-submission"},r.a.createElement("h3",null,"Sign CSR"),r.a.createElement("p",null,"In the future, this will submit the CSR with the correct profile and additional data to RHCS. Currently we're doing it locally to test if this will work with smart cards."),r.a.createElement("button",{onClick:function(){return e.generate()}},"Sign CSR with CA"))}}]),a}(r.a.Component),k=function(e){Object(v.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).state={ca_keys:null,cert_keys:null,csr:null,cert:null},n}return Object(m.a)(a,[{key:"setCAKeys",value:function(e){this.setState((function(t){return Object.assign({},t,{ca_keys:e})}))}},{key:"setCertKeys",value:function(e){this.setState((function(t){return Object.assign({},t,{cert_keys:e})}))}},{key:"setCSR",value:function(e){this.setState((function(t){return Object.assign({},t,{csr:e})}))}},{key:"setCert",value:function(e){this.setState((function(t){return Object.assign({},t,{cert:e})}))}},{key:"toPEM",value:function(e){var t,a="",n="",r=Object(l.a)(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;n.length>=64&&(a+=n+="\r\n",n=""),n+=s}}catch(i){r.e(i)}finally{r.f()}return""!==n&&(a+=n+="\r\n"),a}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},null===this.state.ca_keys?r.a.createElement(d,{setKeys:this.setCAKeys.bind(this)}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"ca-keygen"},r.a.createElement("h3",null,"(DEMO ONLY) Remove CA Keys (DEMO ONLY)"),r.a.createElement("button",{onClick:function(){return e.setCAKeys(null)}},"Delete CA Keys")),null===this.state.cert_keys?r.a.createElement(g,{setKeys:this.setCertKeys.bind(this)}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"cert-keygen"},r.a.createElement("h3",null,"Remove Cert Keys"),r.a.createElement("button",{onClick:function(){return e.setCertKeys(null)}},"Delete Cert Keys")),null===this.state.csr?r.a.createElement(C,{cert_keys:this.state.cert_keys,setCSR:this.setCSR.bind(this)}):r.a.createElement(r.a.Fragment,null,null===this.state.cert?r.a.createElement(S,{ca_keys:this.state.ca_keys,cert_keys:this.state.cert_keys,csr:this.state.csr,setCert:this.setCert.bind(this)}):r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Now check that the keys (CA and Cert) were created on the card."),r.a.createElement("p",null,"For reference, this is the signed end-entity certificate below. For now, the generated CA certificate isn't included."),r.a.createElement("pre",null,"-----BEGIN CERTIFICATE-----\r\n"+this.toPEM(Object(f.i)(Object(f.a)(this.state.cert)))+"-----END CERTIFICATE-----"))))))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[32,1,2]]]);
//# sourceMappingURL=main.175216de.chunk.js.map