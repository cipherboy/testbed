#include <assert.h>
#include <openssl/ec.h>
#include <openssl/objects.h>

int main() {
    BN_CTX *bnctx = BN_CTX_new();
    EC_GROUP *group = EC_GROUP_new_by_curve_name(NID_X9_62_prime256v1);

    EC_POINT *point = EC_POINT_new(group);

    BIGNUM *x = BN_new();
    BIGNUM *y = BN_new();

    // The following points come from the CVE-2019-11234 reproducer.

    // They are part of a subgroup of order 3; this means that the x
    // coordinate of the resulting point is always that of this generator.
    BN_hex2bn(&x, "5a9a06c49c618e65973799292cf4f90a82b2860065cf2de30fb4076dd5b8d28d");
    BN_hex2bn(&y, "bd065f2819e3e25ee3892f04775ffddeb4692a2dcc7ba5205ce729a9b05bead2");

    assert (!EC_POINT_set_affine_coordinates_GFp(group, point, x, y, bnctx));
    return 0;
}
