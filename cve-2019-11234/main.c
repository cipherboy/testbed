#include "eap-pwd.h"

int main() {
    pwd_session_t session;

    /* Not used by process_peer_commit */
    session.state = 0;
    session.group_num = 0;
    session.ciphersuite = 0;
    session.token = 0;
    memset(session.peer_id, 0, MAX_STRING_LEN);
    session.peer_id_len = 0;
    session.mtu = 0;
    session.in = NULL;
    session.in_pos = 0;
    session.in_len = 0;
    session.out = NULL;
    session.out_pos = 0;
    session.out_len = 0;
    memset(session.my_confirm, 0, SHA256_DIGEST_LENGTH);

    /* Things we need to specify */
    session.group = NULL;
    session.pwe = NULL;
    session.order = NULL;
    session.prime = NULL;
    session.k = NULL;
    session.private_value = NULL;
    session.my_scalar = NULL;
    session.my_element = NULL;

    /* Things we create in process_peer_commit */
    session.peer_scalar = NULL;
    session.peer_element = NULL;

    return process_peer_commit(&session, NULL, 0, NULL);
}
